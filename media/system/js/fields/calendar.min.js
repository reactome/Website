<<<<<<< HEAD
!function(window,document){"use strict";Date.convertNumbers=function(str){var str=str.toString();if(Object.prototype.toString.call(JoomlaCalLocale.localLangNumbers)==="[object Array]"){for(var i=0;i<JoomlaCalLocale.localLangNumbers.length;i++){str=str.replace(new RegExp(i,"g"),JoomlaCalLocale.localLangNumbers[i])}}return str};Date.toEnglish=function(str){str=this.toString();var nums=[0,1,2,3,4,5,6,7,8,9];for(var i=0;i<10;i++){str=str.replace(new RegExp(nums[i],"g"),i)}return str};(function(){if(typeof window.CustomEvent==="function")return false;function CustomEvent(event,params){params=params||{bubbles:false,cancelable:false,detail:undefined};var evt=document.createEvent("CustomEvent");evt.initCustomEvent(event,params.bubbles,params.cancelable,params.detail);return evt}window.CustomEvent=CustomEvent})();var JoomlaCalendar=function(element){if(!element){throw new Error("Calendar setup failed:\n  No valid element found, Please check your code")}if(typeof Date.parseFieldDate!=="function"){throw new Error("Calendar setup failed:\n  No valid date helper, Please check your code")}if(element._joomlaCalendar){throw new Error("JoomlaCalendar instance already exists for the element")}element._joomlaCalendar=this;this.writable=true;this.hidden=true;this.params={};this.element=element;this.inputField=element.getElementsByTagName("input")[0];this.button=element.getElementsByTagName("button")[0];if(!this.inputField){throw new Error("Calendar setup failed:\n  No valid input found, Please check your code")}this.params={debug:false,clicked:false,element:{style:{display:"none"}},writable:true};var self=this,btn=this.button,instanceParams={inputField:this.inputField,dateType:JoomlaCalLocale.dateType?JoomlaCalLocale.dateType:"gregorian",direction:document.dir!==undefined?document.dir:document.getElementsByTagName("html")[0].getAttribute("dir"),firstDayOfWeek:btn.getAttribute("data-firstday")?parseInt(btn.getAttribute("data-firstday")):0,dateFormat:"%Y-%m-%d %H:%M:%S",weekend:JoomlaCalLocale.weekend?JoomlaCalLocale.weekend:[0,6],minYear:JoomlaCalLocale.minYear?JoomlaCalLocale.minYear:1900,maxYear:JoomlaCalLocale.maxYear?JoomlaCalLocale.maxYear:2100,minYearTmp:btn.getAttribute("data-min-year"),maxYearTmp:btn.getAttribute("data-max-year"),weekendTmp:btn.getAttribute("data-weekend"),time24:true,showsOthers:parseInt(btn.getAttribute("data-show-others"))===1?true:false,showsTime:true,weekNumbers:parseInt(btn.getAttribute("data-week-numbers"))===1?true:false,showsTodayBtn:true,compressedHeader:parseInt(btn.getAttribute("data-only-months-nav"))===1?true:false};if(btn.getAttribute("data-dayformat")){instanceParams.dateFormat=btn.getAttribute("data-dayformat")?btn.getAttribute("data-dayformat"):"%Y-%m-%d %H:%M:%S"}if(btn.getAttribute("data-time-24")){instanceParams.time24=parseInt(btn.getAttribute("data-time-24"))===24?true:false}if(btn.getAttribute("data-show-time")){instanceParams.showsTime=parseInt(btn.getAttribute("data-show-time"))===1?true:false}if(btn.getAttribute("data-today-btn")){instanceParams.showsTodayBtn=parseInt(btn.getAttribute("data-today-btn"))===1?true:false}for(var param in instanceParams){this.params[param]=instanceParams[param]}if(isInt(self.params.minYearTmp)){self.params.minYear=getBoundary(parseInt(self.params.minYearTmp),self.params.dateType)}if(isInt(self.params.maxYearTmp)){self.params.maxYear=getBoundary(parseInt(self.params.maxYearTmp),self.params.dateType)}if(self.params.weekendTmp!=="undefined"){self.params.weekend=self.params.weekendTmp.split(",").map(function(item){return parseInt(item,10)})}this._dayMouseDown=function(event){return self._handleDayMouseDown(event)};this._calKeyEvent=function(event){return self._handleCalKeyEvent(event)};this._documentClick=function(event){return self._handleDocumentClick(event)};this.checkInputs();if(this.inputField.getAttribute("readonly")){return}this._create();this._bindEvents()};JoomlaCalendar.prototype.checkInputs=function(){var inputAltValueDate=Date.parseFieldDate(this.inputField.getAttribute("data-alt-value"),this.params.dateFormat,"gregorian");if(this.inputField.value!==""){this.date=inputAltValueDate;this.inputField.value=inputAltValueDate.print(this.params.dateFormat,this.params.dateType,true)}else{this.date=new Date}};JoomlaCalendar.prototype.recreate=function(){var element=this.element,el=element.querySelector(".js-calendar");if(el){element._joomlaCalendar=null;el.parentNode.removeChild(el);new JoomlaCalendar(element)}};JoomlaCalendar.prototype.updateTime=function(hours,mins,secs){var self=this,date=self.date;var d=self.date.getLocalDate(self.params.dateType),m=self.date.getLocalMonth(self.params.dateType),y=self.date.getLocalFullYear(self.params.dateType),ampm=this.inputField.parentNode.parentNode.querySelectorAll(".time-ampm")[0];if(!self.params.time24){if(/pm/i.test(ampm.value)&&hours<12){hours=parseInt(hours)+12}else if(/am/i.test(ampm.value)&&hours==12){hours=0}}date.setHours(hours);date.setMinutes(parseInt(mins,10));date.setSeconds(date.getSeconds());date.setLocalFullYear(self.params.dateType,y);date.setLocalMonth(self.params.dateType,m);date.setLocalDate(self.params.dateType,d);self.dateClicked=false;this.callHandler()};JoomlaCalendar.prototype.setDate=function(date){if(!date.equalsTo(this.date)){this.date=date;this.processCalendar(this.params.firstDayOfWeek,date)}};JoomlaCalendar.prototype.moveCursorBy=function(step){var date=new Date(this.date);date.setDate(date.getDate()-step);this.setDate(date)};JoomlaCalendar.prototype.resetSelected=function(element){var options=element.options;var i=options.length;while(i--){var current=options[i];if(current.selected){current.selected=false}}};JoomlaCalendar.prototype.callHandler=function(){this.inputField.setAttribute("data-alt-value",this.date.print(this.params.dateFormat,"gregorian",false));if(this.inputField.getAttribute("data-alt-value")&&this.inputField.getAttribute("data-alt-value")!=="0000-00-00 00:00:00"){this.inputField.value=this.date.print(this.params.dateFormat,this.params.dateType,true);if(this.params.dateType!=="gregorian"){this.inputField.setAttribute("data-local-value",this.date.print(this.params.dateFormat,this.params.dateType,true))}}this.inputField.value=this.date.print(this.params.dateFormat,this.params.dateType,true);if(this.dateClicked&&typeof this.params.onUpdate==="function"){this.params.onUpdate(this)}this.inputField.dispatchEvent(new CustomEvent("change",{bubbles:true,cancelable:true}));if(this.dateClicked){this.close()}else{this.processCalendar()}};JoomlaCalendar.prototype.close=function(){this.hide()};JoomlaCalendar.prototype.show=function(){if(navigator.appName.indexOf("Internet Explorer")!==-1){var badBrowser=navigator.appVersion.indexOf("MSIE 9")===-1&&navigator.appVersion.indexOf("MSIE 1")===-1;if(badBrowser){if(window.jQuery&&jQuery().chosen){var selItems=this.element.getElementsByTagName("select");for(var i=0;i<selItems.length;i++){jQuery(selItems[i]).chosen("destroy")}}}}this.checkInputs();this.inputField.focus();this.dropdownElement.style.display="block";this.hidden=false;document.addEventListener("keydown",this._calKeyEvent,true);document.addEventListener("keypress",this._calKeyEvent,true);document.addEventListener("mousedown",this._documentClick,true);var containerTmp=this.element.querySelector(".js-calendar");if(window.innerHeight<containerTmp.getBoundingClientRect().bottom+20){containerTmp.style.marginTop=-(containerTmp.getBoundingClientRect().height+this.inputField.getBoundingClientRect().height)+"px"}this.processCalendar()};JoomlaCalendar.prototype.hide=function(){document.removeEventListener("keydown",this._calKeyEvent,true);document.removeEventListener("keypress",this._calKeyEvent,true);document.removeEventListener("mousedown",this._documentClick,true);this.dropdownElement.style.display="none";this.hidden=true};JoomlaCalendar.prototype._handleDocumentClick=function(ev){var el=ev.target;if(el!==null&&!el.classList.contains("time")){for(;el!==null&&el!==this.element;el=el.parentNode);}if(el===null){document.activeElement.blur();this.hide();return stopCalEvent(ev)}};JoomlaCalendar.prototype._handleDayMouseDown=function(ev){var self=this,el=ev.currentTarget,target=ev.target||ev.srcElement;if(target&&target.hasAttribute("data-action")){return}if(el.nodeName!=="TD"){var testel=el.getParent("TD");if(testel.nodeName==="TD"){el=testel}else{el=el.getParent("TD");if(el.classList.contains("js-calendar")){el=el.getElementsByTagName("table")[0]}}}else{if(!target.classList.contains("js-btn")&&!el.classList.contains("day")&&!el.classList.contains("title")){return}}if(!el||el.disabled){return false}if(typeof el.navtype==="undefined"||el.navtype!==300){if(el.navtype===50){el._current=el.innerHTML}if(target===el||target.parentNode===el){self.cellClick(el,ev)}var mon=null;if(typeof el.month!=="undefined"){mon=el}if(typeof el.parentNode.month!=="undefined"){mon=el.parentNode}var date=null;if(mon){date=new Date(self.date);if(mon.month!==date.getLocalMonth(self.params.dateType)){date.setLocalMonth(self.params.dateType,mon.month);self.setDate(date);self.dateClicked=false;this.callHandler()}}else{var year=null;if(typeof el.year!=="undefined"){year=target}if(typeof el.parentNode.year!=="undefined"){year=target.parentNode}if(year){date=new Date(self.date);if(year.year!==date.getLocalFullYear(self.params.dateType)){date.setFullYear(self.params.dateType,year.year);self.setDate(date);self.dateClicked=false;this.callHandler()}}}}return stopCalEvent(ev)};JoomlaCalendar.prototype.cellClick=function(el,ev){var self=this,closing=false,newdate=false,date=null;if(typeof el.navtype==="undefined"){if(self.currentDateEl){el.classList.add("selected");self.currentDateEl=el.caldate;closing=self.currentDateEl===el.caldate;if(!closing){self.currentDateEl=el.caldate}}self.date.setLocalDateOnly("gregorian",el.caldate);var other_month=!(self.dateClicked=!el.otherMonth);if(self.currentDateEl){newdate=!el.disabled}if(other_month){this.processCalendar()}}else{date=new Date(self.date);self.dateClicked=false;var year=date.getOtherFullYear(self.params.dateType),mon=date.getLocalMonth(self.params.dateType);switch(el.navtype){case 400:break;case-2:if(!self.params.compressedHeader){if(year>self.params.minYear){date.setOtherFullYear(self.params.dateType,year-1)}}break;case-1:var day=date.getLocalDate(self.params.dateType);if(mon>0){var max=date.getLocalMonthDays(self.params.dateType,mon-1);if(day>max){date.setLocalDate(self.params.dateType,max)}date.setLocalMonth(self.params.dateType,mon-1)}else if(year-- >self.params.minYear){date.setOtherFullYear(self.params.dateType,year);var max=date.getLocalMonthDays(self.params.dateType,11);if(day>max){date.setLocalDate(self.params.dateType,max)}date.setLocalMonth(self.params.dateType,11)}break;case 1:var day=date.getLocalDate(self.params.dateType);if(mon<11){var max=date.getLocalMonthDays(self.params.dateType,mon+1);if(day>max){date.setLocalDate(self.params.dateType,max)}date.setLocalMonth(self.params.dateType,mon+1)}else if(year<self.params.maxYear){date.setOtherFullYear(self.params.dateType,year+1);var max=date.getLocalMonthDays(self.params.dateType,0);if(day>max){date.setLocalDate(self.params.dateType,max)}date.setLocalMonth(self.params.dateType,0)}break;case 2:if(!self.params.compressedHeader)if(year<self.params.maxYear){date.setOtherFullYear(self.params.dateType,year+1)}break;case 0:break}if(!date.equalsTo(self.date)){this.setDate(date);newdate=true}else if(el.navtype===0){newdate=closing=true}}if(newdate){if(self.params.showsTime){this.dateClicked=false}ev&&this.callHandler()}el.classList.remove("hilite");if(closing&&!self.params.showsTime){self.dateClicked=false;ev&&this.close()}};JoomlaCalendar.prototype._handleCalKeyEvent=function(ev){var self=this,K=ev.keyCode;if(ev.target===this.inputField&&(K===13||K===9)){this.close()}if(self.params.direction==="rtl"){if(K===37){K=39}else if(K===39){K=37}}if(K===32){if(ev.shiftKey){ev.preventDefault();this.cellClick(self._nav_now,ev);self.close()}}if(K===27){this.close()}if(K===38){this.moveCursorBy(7)}if(K===40){this.moveCursorBy(-7)}if(K===37){this.moveCursorBy(1)}if(K===39){this.moveCursorBy(-1)}if(ev.target===this.inputField&&!(K>48||K<57||K===186||K===189||K===190||K===32)){return stopCalEvent(ev)}};JoomlaCalendar.prototype._create=function(){var self=this,parent=this.element,table=createElement("table"),div=createElement("div");this.table=table;table.className="table";table.cellSpacing=0;table.cellPadding=0;table.style.marginBottom=0;this.dropdownElement=div;parent.appendChild(div);if(this.params.direction){div.style.direction=this.params.direction}div.className="js-calendar";div.style.position="absolute";div.style.boxShadow="0px 0px 70px 0px rgba(0,0,0,0.67)";div.style.minWidth=this.inputField.width;div.style.padding="0";div.style.display="none";div.style.left="auto";div.style.top="auto";div.style.zIndex=1060;div.style.borderRadius="20px";this.wrapper=createElement("div");this.wrapper.className="calendar-container";div.appendChild(this.wrapper);this.wrapper.appendChild(table);var thead=createElement("thead",table);thead.className="calendar-header";var cell=null,row=null,cal=this,hh=function(text,cs,navtype,node,styles,classes,attributes){node=node?node:"td";styles=styles?styles:{};cell=createElement(node,row);if(cs){classes=classes?'class="'+classes+'"':"";cell.colSpan=cs}for(var key in styles){cell.style[key]=styles[key]}for(var key in attributes){cell.setAttribute(key,attributes[key])}if(navtype!==0&&Math.abs(navtype)<=2){cell.className+=" nav"}if(cs){cell.addEventListener("mousedown",self._dayMouseDown,true)}cell.calendar=cal;cell.navtype=navtype;if(navtype!==0&&Math.abs(navtype)<=2){cell.innerHTML="<a "+classes+" style='display:inline;padding:2px 6px;cursor:pointer;text-decoration:none;' unselectable='on'>"+text+"</a>"}else{cell.innerHTML=cs?"<div unselectable='on'"+classes+">"+text+"</div>":text;if(!cs&&classes){cell.className=classes}}return cell};if(this.params.compressedHeader===false){row=createElement("tr",thead);row.className="calendar-head-row";this._nav_py=hh("&lsaquo;",1,-2,"",{"text-align":"center","font-size":"18px","line-height":"18px"},"js-btn btn-prev-year");this.title=hh('<div style="text-align:center;font-size:18px"><span></span></div>',this.params.weekNumbers?6:5,300);this.title.className="title";this._nav_ny=hh(" &rsaquo;",1,2,"",{"text-align":"center","font-size":"18px","line-height":"18px"},"js-btn btn-next-year")}row=createElement("tr",thead);row.className="calendar-head-row";this._nav_pm=hh("&lsaquo;",1,-1,"",{"text-align":"center","font-size":"2em","line-height":"1em"},"js-btn btn-prev-month");this._nav_month=hh('<div style="text-align:center;font-size:1.2em"><span></span></div>',this.params.weekNumbers?6:5,888,"td",{textAlign:"center"});this._nav_month.className="title";this._nav_nm=hh(" &rsaquo;",1,1,"",{"text-align":"center","font-size":"2em","line-height":"1em"},"js-btn btn-next-month");row=createElement("tr",thead);row.className=self.params.weekNumbers?"daynames wk":"daynames";if(this.params.weekNumbers){cell=createElement("td",row);cell.className="day-name wn";cell.innerHTML=JoomlaCalLocale.wk}for(var i=7;i>0;--i){cell=createElement("td",row);if(!i){cell.calendar=self}}this.firstdayname=this.params.weekNumbers?row.firstChild.nextSibling:row.firstChild;var fdow=this.params.firstDayOfWeek,cell=this.firstdayname,weekend=JoomlaCalLocale.weekend;for(var i=0;i<7;++i){var realday=(i+fdow)%7;cell.classList.add("day-name");this.params.weekNumbers?cell.classList.add("day-name-week"):"";if(i){cell.calendar=self;cell.fdow=realday}if(weekend.indexOf(weekend)!==-1){cell.classList.add("weekend")}cell.innerHTML=JoomlaCalLocale.shortDays[(i+fdow)%7];cell=cell.nextSibling}var tbody=createElement("tbody",table);this.tbody=tbody;for(i=6;i>0;--i){row=createElement("tr",tbody);if(this.params.weekNumbers){cell=createElement("td",row)}for(var j=7;j>0;--j){cell=createElement("td",row);cell.calendar=this;cell.addEventListener("mousedown",this._dayMouseDown,true)}}if(this.params.showsTime){row=createElement("tr",tbody);row.className="time";cell=createElement("td",row);cell.className="time time-title";cell.colSpan=1;cell.style.verticalAlign="middle";cell.innerHTML=" ";var cell1=createElement("td",row);cell1.className="time hours-select";cell1.colSpan=2;var cell2=createElement("td",row);cell2.className="time minutes-select";cell2.colSpan=2;(function(){function makeTimePart(className,selected,range_start,range_end,cellTml){var part=createElement("select",cellTml),num;part.calendar=self;part.className=className;part.setAttribute("data-chosen",true);part.style.width="100%";part.navtype=50;part._range=[];for(var i=range_start;i<=range_end;++i){var txt,selAttr="";if(i===selected){selAttr=true}if(i<10&&range_end>=10){num="0"+i;txt=Date.convertNumbers("0")+Date.convertNumbers(i)}else{num=""+i;txt=""+Date.convertNumbers(i)}part.options.add(new Option(txt,num,selAttr,selAttr))}return part}var hrs=self.date.getHours(),mins=self.date.getMinutes(),t12=!self.params.time24,pm=self.date.getHours()>12;if(t12&&pm){hrs-=12}var H=makeTimePart("time time-hours",hrs,t12?1:0,t12?12:23,cell1),M=makeTimePart("time time-minutes",mins,0,59,cell2),AP=null;cell=createElement("td",row);cell.className="time ampm-select";cell.colSpan=self.params.weekNumbers?1:2;if(t12){var selAttr=true,altDate=Date.parseFieldDate(self.inputField.getAttribute("data-alt-value"),self.params.dateFormat,"gregorian");pm=altDate.getHours()>=12;var part=createElement("select",cell);part.className="time-ampm";part.style.width="100%";part.options.add(new Option(JoomlaCalLocale.PM,"pm",pm?selAttr:"",pm?selAttr:""));part.options.add(new Option(JoomlaCalLocale.AM,"am",pm?"":selAttr,pm?"":selAttr));AP=part;AP.addEventListener("change",function(event){self.updateTime(event.target.parentNode.parentNode.childNodes[1].childNodes[0].value,event.target.parentNode.parentNode.childNodes[2].childNodes[0].value,event.target.parentNode.parentNode.childNodes[3].childNodes[0].value)},false)}else{cell.innerHTML="&#160;";cell.colSpan=self.params.weekNumbers?3:2}H.addEventListener("change",function(event){self.updateTime(event.target.parentNode.parentNode.childNodes[1].childNodes[0].value,event.target.parentNode.parentNode.childNodes[2].childNodes[0].value,event.target.parentNode.parentNode.childNodes[3].childNodes[0].value)},false);M.addEventListener("change",function(event){self.updateTime(event.target.parentNode.parentNode.childNodes[1].childNodes[0].value,event.target.parentNode.parentNode.childNodes[2].childNodes[0].value,event.target.parentNode.parentNode.childNodes[3].childNodes[0].value)},false)})()}row=createElement("div",this.wrapper);row.className="buttons-wrapper btn-group";this._nav_clear=hh(JoomlaCalLocale.clear,"",100,"button","","js-btn btn btn-clear",{type:"button","data-action":"clear"});var cleara=row.querySelector('[data-action="clear"]');cleara.addEventListener("click",function(e){e.preventDefault();var days=self.table.querySelectorAll("td");for(var i=0;i<days.length;i++){if(days[i].classList.contains("selected")){days[i].classList.remove("selected");break}}self.inputField.setAttribute("data-alt-value","0000-00-00 00:00:00");self.inputField.setAttribute("value","");self.inputField.value="";self.inputField.dispatchEvent(new CustomEvent("change",{bubbles:true,cancelable:true}))});if(this.params.showsTodayBtn){this._nav_now=hh(JoomlaCalLocale.today,"",0,"button","","js-btn btn btn-today",{type:"button","data-action":"today"});var todaya=this.wrapper.querySelector('[data-action="today"]');todaya.addEventListener("click",function(e){e.preventDefault();self.date.setLocalDateOnly("gregorian",new Date);self.dateClicked=true;self.callHandler();self.close()})}this._nav_exit=hh(JoomlaCalLocale.exit,"",999,"button","","js-btn btn btn-exit",{type:"button","data-action":"exit"});var exita=this.wrapper.querySelector('[data-action="exit"]');exita.addEventListener("click",function(e){e.preventDefault();if(!self.dateClicked){if(self.inputField.value){if(self.params.dateType!=="gregorian"){self.inputField.setAttribute("data-local-value",self.inputField.value)}if(typeof self.dateClicked==="undefined"){self.inputField.setAttribute("data-alt-value",Date.parseFieldDate(self.inputField.value,self.params.dateFormat,self.params.dateType).print(self.params.dateFormat,"gregorian",false))}else{self.inputField.setAttribute("data-alt-value",self.date.print(self.params.dateFormat,"gregorian",false))}}else{self.inputField.setAttribute("data-alt-value","0000-00-00 00:00:00")}self.date=Date.parseFieldDate(self.inputField.getAttribute("data-alt-value"),self.params.dateFormat,self.params.dateType)}self.close()});this.processCalendar()};JoomlaCalendar.prototype.processCalendar=function(){this.table.style.visibility="hidden";var firstDayOfWeek=this.params.firstDayOfWeek,date=this.date,today=new Date,TY=today.getLocalFullYear(this.params.dateType),TM=today.getLocalMonth(this.params.dateType),TD=today.getLocalDate(this.params.dateType),year=date.getOtherFullYear(this.params.dateType),hrs=date.getHours(),mins=date.getMinutes(),secs=date.getSeconds(),t12=!this.params.time24;if(year<this.params.minYear){year=this.params.minYear;date.setOtherFullYear(this.params.dateType,year)}else if(year>this.params.maxYear){year=this.params.maxYear;date.setOtherFullYear(this.params.dateType,year)}this.params.firstDayOfWeek=firstDayOfWeek;this.date=new Date(date);var month=date.getLocalMonth(this.params.dateType);var mday=date.getLocalDate(this.params.dateType);date.setLocalDate(this.params.dateType,1);var day1=(date.getLocalDay(this.params.dateType)-this.params.firstDayOfWeek)%7;if(day1<0){day1+=7}date.setLocalDate(this.params.dateType,-day1);date.setLocalDate(this.params.dateType,date.getLocalDate(this.params.dateType)+1);var row=this.tbody.firstChild,ar_days=this.ar_days=new Array,weekend=JoomlaCalLocale.weekend,monthDays=parseInt(date.getLocalWeekDays(this.params.dateType));for(var i=0;i<monthDays;++i,row=row.nextSibling){var cell=row.firstChild;if(this.params.weekNumbers){cell.className="day wn";cell.innerHTML=date.getLocalWeekNumber(this.params.dateType);cell=cell.nextSibling}row.className=this.params.weekNumbers?"daysrow wk":"daysrow";var hasdays=false,iday,dpos=ar_days[i]=[],totalDays=monthDays+1;for(var j=0;j<totalDays;++j,cell=cell.nextSibling,date.setLocalDate(this.params.dateType,iday+1)){cell.className="day";cell.style["textAlign"]="center";iday=date.getLocalDate(this.params.dateType);var wday=date.getLocalDay(this.params.dateType);cell.pos=i<<4|j;dpos[j]=cell;var current_month=date.getLocalMonth(this.params.dateType)===month;if(!current_month){if(this.params.showsOthers){cell.className+=" disabled othermonth ";cell.otherMonth=true}else{cell.className+=" emptycell";cell.innerHTML="&#160;";cell.disabled=true;continue}}else{cell.otherMonth=false;hasdays=true;cell.style.cursor="pointer"}cell.disabled=false;cell.innerHTML=this.params.debug?iday:Date.convertNumbers(iday);if(!cell.disabled){cell.caldate=new Date(date);if(current_month&&iday===mday){cell.className+=" selected";this.currentDateEl=cell}if(date.getLocalFullYear(this.params.dateType)===TY&&date.getLocalMonth(this.params.dateType)===TM&&iday===TD){cell.className+=" today"}if(weekend.indexOf(wday)!==-1)cell.className+=" weekend"}}if(!(hasdays||this.params.showsOthers)){row.style.display="none";row.className="emptyrow"}else{row.style.display=""}}if(this.params.showsTime){if(hrs>12&&t12){hrs-=12}hrs=hrs<10?"0"+hrs:hrs;mins=mins<10?"0"+mins:mins;var hoursEl=this.table.querySelector(".time-hours"),minsEl=this.table.querySelector(".time-minutes");this.resetSelected(hoursEl);if(!this.params.time24){hoursEl.value=hrs=="00"?"12":hrs}else{hoursEl.value=hrs}this.resetSelected(minsEl);minsEl.value=mins;if(!this.params.time24){var dateAlt=new Date(this.inputField.getAttribute("data-alt-value")),ampmEl=this.table.querySelector(".time-ampm"),hrsAlt=dateAlt.getHours();if(hrsAlt>12){this.resetSelected(ampmEl);ampmEl.value="pm"}}}if(!this.params.compressedHeader){this._nav_month.getElementsByTagName("span")[0].innerHTML=this.params.debug?month+" "+JoomlaCalLocale.months[month]:JoomlaCalLocale.months[month];this.title.getElementsByTagName("span")[0].innerHTML=this.params.debug?year+" "+Date.convertNumbers(year.toString()):Date.convertNumbers(year.toString())}else{var tmpYear=Date.convertNumbers(year.toString());this._nav_month.getElementsByTagName("span")[0].innerHTML=!this.params.monthBefore?JoomlaCalLocale.months[month]+" - "+tmpYear:tmpYear+" - "+JoomlaCalLocale.months[month]}this.table.style.visibility="visible"};JoomlaCalendar.prototype._bindEvents=function(){var self=this;this.inputField.addEventListener("blur",function(event){var calObj=JoomlaCalendar.getCalObject(this)._joomlaCalendar;if(calObj.dropdownElement.style.display==="block"){event.preventDefault();return}if(calObj){if(calObj.inputField.value){if(typeof calObj.params.dateClicked==="undefined"){calObj.inputField.setAttribute("data-local-value",calObj.inputField.value);if(calObj.params.dateType!=="gregorian"){var ndate,date=Date.parseFieldDate(calObj.inputField.value,calObj.params.dateFormat,calObj.params.dateType);ndate=Date.localCalToGregorian(date.getFullYear(),date.getMonth(),date.getDate());date.setFullYear(ndate[0]);date.setMonth(ndate[1]);date.setDate(ndate[2]);calObj.inputField.setAttribute("data-alt-value",date.print(calObj.params.dateFormat,"gregorian",false))}else{calObj.inputField.setAttribute("data-alt-value",Date.parseFieldDate(calObj.inputField.value,calObj.params.dateFormat,calObj.params.dateType).print(calObj.params.dateFormat,"gregorian",false))}}else{calObj.inputField.setAttribute("data-alt-value",calObj.date.print(calObj.params.dateFormat,"gregorian",false))}}else{calObj.inputField.setAttribute("data-alt-value","0000-00-00 00:00:00")}calObj.date=Date.parseFieldDate(calObj.inputField.getAttribute("data-alt-value"),calObj.params.dateFormat,calObj.params.dateType)}self.close()},true);this.button.addEventListener("click",function(){self.show()},false)};var stopCalEvent=function(ev){ev||(ev=window.event);ev.preventDefault();ev.stopPropagation();return false};var createElement=function(type,parent){var el=null;el=document.createElement(type);if(typeof parent!=="undefined"){parent.appendChild(el)}return el};var isInt=function(input){return!isNaN(input)&&function(x){return(x|0)===x}(parseFloat(input))};var getBoundary=function(input,type){var date=new Date;var y=date.getLocalFullYear(type);return y+input};if(!Array.prototype.indexOf){Array.prototype.indexOf=function(elt){var len=this.length>>>0,from=Number(arguments[1])||0;from=from<0?Math.ceil(from):Math.floor(from);if(from<0){from+=len}for(;from<len;from++){if(from in this&&this[from]===elt){return from}}return-1}}JoomlaCalendar.getCalObject=function(element){if(!element){return false}while(element.parentNode){element=element.parentNode;if(element.classList.contains("field-calendar")){return element}}return false};JoomlaCalendar.prototype.setAltValue=function(){var input=this.inputField;if(input.getAttribute("disabled"))return;input.value=input.getAttribute("data-alt-value")?input.getAttribute("data-alt-value"):""};JoomlaCalendar.onSubmit=function(){Joomla=window.Joomla||{};if(!Joomla.calendarProcessed){Joomla.calendarProcessed=true;var elements=document.querySelectorAll(".field-calendar");for(var i=0;i<elements.length;i++){var element=elements[i],instance=element._joomlaCalendar;if(instance){instance.setAltValue()}}}};JoomlaCalendar.init=function(element,container){window.JoomlaCalLocale=window.JoomlaCalLocale?JoomlaCalLocale:{};JoomlaCalLocale.today=JoomlaCalLocale.today?JoomlaCalLocale.today:"today";JoomlaCalLocale.weekend=JoomlaCalLocale.weekend?JoomlaCalLocale.weekend:[0,6];JoomlaCalLocale.localLangNumbers=JoomlaCalLocale.localLangNumbers?JoomlaCalLocale.localLangNumbers:[0,1,2,3,4,5,6,7,8,9];JoomlaCalLocale.wk=JoomlaCalLocale.wk?JoomlaCalLocale.wk:"wk";JoomlaCalLocale.AM=JoomlaCalLocale.AM?JoomlaCalLocale.AM:"AM";JoomlaCalLocale.PM=JoomlaCalLocale.PM?JoomlaCalLocale.PM:"PM";JoomlaCalLocale.am=JoomlaCalLocale.am?JoomlaCalLocale.am:"am";JoomlaCalLocale.pm=JoomlaCalLocale.pm?JoomlaCalLocale.pm:"pm";JoomlaCalLocale.dateType=JoomlaCalLocale.dateType?JoomlaCalLocale.dateType:"gregorian";JoomlaCalLocale.time=JoomlaCalLocale.time?JoomlaCalLocale.time:"time";JoomlaCalLocale.days=JoomlaCalLocale.days?JoomlaCalLocale.days:'["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"]';JoomlaCalLocale.shortDays=JoomlaCalLocale.shortDays?JoomlaCalLocale.shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"];JoomlaCalLocale.months=JoomlaCalLocale.months?JoomlaCalLocale.months:["January","February","March","April","May","June","July","August","September","October","November","December"];JoomlaCalLocale.shortMonths=JoomlaCalLocale.shortMonths?JoomlaCalLocale.shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];JoomlaCalLocale.minYear=JoomlaCalLocale.minYear?JoomlaCalLocale.minYear:1900;JoomlaCalLocale.maxYear=JoomlaCalLocale.maxYear?JoomlaCalLocale.maxYear:2100;JoomlaCalLocale.exit=JoomlaCalLocale.exit?JoomlaCalLocale.exit:"Cancel";JoomlaCalLocale.clear=JoomlaCalLocale.clear?JoomlaCalLocale.clear:"Clear";var instance=element._joomlaCalendar;if(!instance){new JoomlaCalendar(element)}else{instance.recreate()}if(element&&element.getElementsByTagName("input")[0]&&element.getElementsByTagName("input")[0].form&&!element.getElementsByTagName("input")[0].disabled){element.getElementsByTagName("input")[0].form.addEventListener("submit",JoomlaCalendar.onSubmit)}};window.JoomlaCalendar=JoomlaCalendar;document.addEventListener("DOMContentLoaded",function(){var elements,i;elements=document.querySelectorAll(".field-calendar");for(i=0;i<elements.length;i++){JoomlaCalendar.init(elements[i])}window.jQuery&&jQuery(document).on("subform-row-add",function(event,row){elements=row.querySelectorAll(".field-calendar");for(i=0;i<elements.length;i++){JoomlaCalendar.init(elements[i])}});window.Calendar={};Calendar.setup=function(obj){if(obj.inputField&&document.getElementById(obj.inputField)){var element=document.getElementById(obj.inputField),cal=element.parentNode.querySelectorAll("button")[0];for(var property in obj){if(obj.hasOwnProperty(property)){switch(property){case"ifFormat":if(cal)cal.setAttribute("data-dayformat",obj.ifFormat);break;case"firstDay":if(cal)cal.setAttribute("data-firstday",parseInt(obj.firstDay));break;case"weekNumbers":if(cal)cal.setAttribute("data-week-numbers",obj.weekNumbers==="true"||obj.weekNumbers===true?"1":"0");break;case"showOthers":if(cal)cal.setAttribute("data-show-others",obj.showOthers==="true"||obj.showOthers===true?"1":"0");break;case"showsTime":if(cal)cal.setAttribute("data-show-time",obj.showsTime==="true"||obj.showsTime===true?"1":"0");break;case"timeFormat":if(cal)cal.setAttribute("data-time-24",parseInt(obj.timeFormat));break;case"displayArea":case"inputField":case"button":case"eventName":case"daFormat":case"disableFunc":case"dateStatusFunc":case"dateTooltipFunc":case"dateText":case"align":case"range":case"flat":case"flatCallback":case"onSelect":case"onClose":case"onUpdate":case"date":case"electric":case"step":case"position":case"cache":case"multiple":break}}}JoomlaCalendar.init(element.parentNode.parentNode)}return null}})}(window,document);
=======
!(function(f,a){Date.convertNumbers=function(j){var j=j.toString();if(Object.prototype.toString.call(JoomlaCalLocale.localLangNumbers)==="[object Array]"){for(var h=0;h<JoomlaCalLocale.localLangNumbers.length;h++){j=j.replace(new RegExp(h,"g"),JoomlaCalLocale.localLangNumbers[h])}}return j};Date.toEnglish=function(k){k=this.toString();var j=[0,1,2,3,4,5,6,7,8,9];for(var h=0;h<10;h++){k=k.replace(new RegExp(j[h],"g"),h)}return k};var b=function(j){if(!j){throw new Error("Calendar setup failed:\n  No valid element found, Please check your code")}if(typeof Date.parseFieldDate!=="function"){throw new Error("Calendar setup failed:\n  No valid date helper, Please check your code")}if(j._joomlaCalendar){throw new Error("JoomlaCalendar instance already exists for the element")}j._joomlaCalendar=this;this.writable=true;this.hidden=true;this.params={};this.element=j;this.inputField=j.getElementsByTagName("input")[0];this.button=j.getElementsByTagName("button")[0];if(!this.inputField){throw new Error("Calendar setup failed:\n  No valid input found, Please check your code")}this.params={debug:false,clicked:false,element:{style:{display:"none"}},writable:true};var h=this,i=this.button,k={inputField:this.inputField,dateType:JoomlaCalLocale.dateType?JoomlaCalLocale.dateType:"gregorian",direction:(a.dir!==undefined)?a.dir:a.getElementsByTagName("html")[0].getAttribute("dir"),firstDayOfWeek:i.getAttribute("data-firstday")?parseInt(i.getAttribute("data-firstday")):0,dateFormat:"%Y-%m-%d %H:%M:%S",weekend:JoomlaCalLocale.weekend?JoomlaCalLocale.weekend:[0,6],minYear:JoomlaCalLocale.minYear?JoomlaCalLocale.minYear:1900,maxYear:JoomlaCalLocale.maxYear?JoomlaCalLocale.maxYear:2100,minYearTmp:i.getAttribute("data-min-year"),maxYearTmp:i.getAttribute("data-max-year"),weekendTmp:i.getAttribute("data-weekend"),time24:true,showsOthers:(parseInt(i.getAttribute("data-show-others"))===1)?true:false,showsTime:true,weekNumbers:(parseInt(i.getAttribute("data-week-numbers"))===1)?true:false,showsTodayBtn:true,compressedHeader:(parseInt(i.getAttribute("data-only-months-nav"))===1)?true:false};if(i.getAttribute("data-dayformat")){k.dateFormat=i.getAttribute("data-dayformat")?i.getAttribute("data-dayformat"):"%Y-%m-%d %H:%M:%S"}if(i.getAttribute("data-time-24")){k.time24=parseInt(i.getAttribute("data-time-24"))===24?true:false}if(i.getAttribute("data-show-time")){k.showsTime=parseInt(i.getAttribute("data-show-time"))===1?true:false}if(i.getAttribute("data-today-btn")){k.showsTodayBtn=parseInt(i.getAttribute("data-today-btn"))===1?true:false}for(var l in k){this.params[l]=k[l]}if(g(h.params.minYearTmp)){h.params.minYear=c(parseInt(h.params.minYearTmp),h.params.dateType)}if(g(h.params.maxYearTmp)){h.params.maxYear=c(parseInt(h.params.maxYearTmp),h.params.dateType)}if(h.params.weekendTmp!=="undefined"){h.params.weekend=h.params.weekendTmp.split(",").map(function(m){return parseInt(m,10)})}this._dayMouseDown=function(m){return h._handleDayMouseDown(m)};this._calKeyEvent=function(m){return h._handleCalKeyEvent(m)};this._documentClick=function(m){return h._handleDocumentClick(m)};this.checkInputs();if(this.inputField.getAttribute("readonly")){return}this._create();this._bindEvents()};b.prototype.checkInputs=function(){var h=Date.parseFieldDate(this.inputField.getAttribute("data-alt-value"),this.params.dateFormat,"gregorian");if(this.inputField.value!==""){this.date=h;this.inputField.value=h.print(this.params.dateFormat,this.params.dateType,true)}else{this.date=new Date()}};b.prototype.recreate=function(){var h=this.element,i=h.querySelector(".js-calendar");if(i){h._joomlaCalendar=null;i.parentNode.removeChild(i);new b(h)}};b.prototype.updateTime=function(p,h,k){var q=this,i=q.date;var l=q.date.getLocalDate(q.params.dateType),j=q.date.getLocalMonth(q.params.dateType),o=q.date.getLocalFullYear(q.params.dateType),n=this.inputField.parentNode.parentNode.querySelectorAll(".time-ampm")[0];if(!q.params.time24){if(/pm/i.test(n.value)&&p<12){p=parseInt(p)+12}else{if(/am/i.test(n.value)&&p==12){p=0}}}i.setHours(p);i.setMinutes(parseInt(h,10));i.setSeconds(i.getSeconds());i.setLocalFullYear(q.params.dateType,o);i.setLocalMonth(q.params.dateType,j);i.setLocalDate(q.params.dateType,l);q.dateClicked=false;this.callHandler()};b.prototype.setDate=function(h){if(!h.equalsTo(this.date)){this.date=h;this.processCalendar(this.params.firstDayOfWeek,h)}};b.prototype.moveCursorBy=function(i){var h=new Date(this.date);h.setDate(h.getDate()-i);this.setDate(h)};b.prototype.resetSelected=function(k){var h=k.options;var j=h.length;while(j--){var l=h[j];if(l.selected){l.selected=false}}};b.prototype.callHandler=function(){this.inputField.setAttribute("data-alt-value",this.date.print(this.params.dateFormat,"gregorian",false));if(this.inputField.getAttribute("data-alt-value")&&this.inputField.getAttribute("data-alt-value")!=="0000-00-00 00:00:00"){this.inputField.value=this.date.print(this.params.dateFormat,this.params.dateType,true);if(this.params.dateType!=="gregorian"){this.inputField.setAttribute("data-local-value",this.date.print(this.params.dateFormat,this.params.dateType,true))}}this.inputField.value=this.date.print(this.params.dateFormat,this.params.dateType,true);if(this.dateClicked&&typeof this.params.onUpdate==="function"){this.params.onUpdate(this)}this.inputField.dispatchEvent(new Event("change",{bubbles:true,cancelable:true}));if(this.dateClicked){this.close()}else{this.processCalendar()}};b.prototype.close=function(){this.hide()};b.prototype.show=function(){if(navigator.appName.indexOf("Internet Explorer")!==-1){var l=(navigator.appVersion.indexOf("MSIE 9")===-1&&navigator.appVersion.indexOf("MSIE 1")===-1);if(l){if(f.jQuery&&jQuery().chosen){var h=this.element.getElementsByTagName("select");for(var k=0;k<h.length;k++){jQuery(h[k]).chosen("destroy")}}}}this.checkInputs();this.inputField.focus();this.dropdownElement.style.display="block";this.hidden=false;a.addEventListener("keydown",this._calKeyEvent,true);a.addEventListener("keypress",this._calKeyEvent,true);a.addEventListener("mousedown",this._documentClick,true);var j=this.element.querySelector(".js-calendar");if(f.innerHeight<j.getBoundingClientRect().bottom+20){j.style.marginTop=-(j.getBoundingClientRect().height+this.inputField.getBoundingClientRect().height)+"px"}this.processCalendar()};b.prototype.hide=function(){a.removeEventListener("keydown",this._calKeyEvent,true);a.removeEventListener("keypress",this._calKeyEvent,true);a.removeEventListener("mousedown",this._documentClick,true);this.dropdownElement.style.display="none";this.hidden=true};b.prototype._handleDocumentClick=function(i){var h=i.target;if(h!==null&&!h.classList.contains("time")){for(;h!==null&&h!==this.element;h=h.parentNode){}}if(h===null){a.activeElement.blur();this.hide();return e(i)}};b.prototype._handleDayMouseDown=function(m){var h=this,l=m.currentTarget,o=m.target||m.srcElement;if(o&&o.hasAttribute("data-action")){return}if(l.nodeName!=="TD"){var n=l.getParent("TD");if(n.nodeName==="TD"){l=n}else{l=l.getParent("TD");if(l.classList.contains("js-calendar")){l=l.getElementsByTagName("table")[0]}}}else{if(!(o.classList.contains("js-btn"))&&!l.classList.contains("day")&&!l.classList.contains("title")){return}}if(!l||l.disabled){return false}if(typeof l.navtype==="undefined"||l.navtype!==300){if(l.navtype===50){l._current=l.innerHTML}if(o===l||o.parentNode===l){h.cellClick(l,m)}var k=null;if(typeof l.month!=="undefined"){k=l}if(typeof l.parentNode.month!=="undefined"){k=l.parentNode}var i=null;if(k){i=new Date(h.date);if(k.month!==i.getLocalMonth(h.params.dateType)){i.setLocalMonth(h.params.dateType,k.month);h.setDate(i);h.dateClicked=false;this.callHandler()}}else{var j=null;if(typeof l.year!=="undefined"){j=o}if(typeof l.parentNode.year!=="undefined"){j=o.parentNode}if(j){i=new Date(h.date);if(j.year!==i.getLocalFullYear(h.params.dateType)){i.setFullYear(h.params.dateType,j.year);h.setDate(i);h.dateClicked=false;this.callHandler()}}}}return e(m)};b.prototype.cellClick=function(i,q){var r=this,l=false,m=false,j=null;if(typeof i.navtype==="undefined"){if(r.currentDateEl){i.classList.add("selected");r.currentDateEl=i.caldate;l=(r.currentDateEl===i.caldate);if(!l){r.currentDateEl=i.caldate}}r.date.setLocalDateOnly("gregorian",i.caldate);var h=!(r.dateClicked=!i.otherMonth);if(r.currentDateEl){m=!i.disabled}if(h){this.processCalendar()}}else{j=new Date(r.date);r.dateClicked=false;var n=j.getOtherFullYear(r.params.dateType),k=j.getLocalMonth(r.params.dateType);switch(i.navtype){case 400:break;case -2:if(!r.params.compressedHeader){if(n>r.params.minYear){j.setOtherFullYear(r.params.dateType,n-1)}}break;case -1:var p=j.getLocalDate(r.params.dateType);if(k>0){var o=j.getLocalMonthDays(r.params.dateType,k-1);if(p>o){j.setLocalDate(r.params.dateType,o)}j.setLocalMonth(r.params.dateType,k-1)}else{if(n-->r.params.minYear){j.setOtherFullYear(r.params.dateType,n);var o=j.getLocalMonthDays(r.params.dateType,11);if(p>o){j.setLocalDate(r.params.dateType,o)}j.setLocalMonth(r.params.dateType,11)}}break;case 1:var p=j.getLocalDate(r.params.dateType);if(k<11){var o=j.getLocalMonthDays(r.params.dateType,k+1);if(p>o){j.setLocalDate(r.params.dateType,o)}j.setLocalMonth(r.params.dateType,k+1)}else{if(n<r.params.maxYear){j.setOtherFullYear(r.params.dateType,n+1);var o=j.getLocalMonthDays(r.params.dateType,0);if(p>o){j.setLocalDate(r.params.dateType,o)}j.setLocalMonth(r.params.dateType,0)}}break;case 2:if(!r.params.compressedHeader){if(n<r.params.maxYear){j.setOtherFullYear(r.params.dateType,n+1)}}break;case 0:break}if(!j.equalsTo(r.date)){this.setDate(j);m=true}else{if(i.navtype===0){m=l=true}}}if(m){if(r.params.showsTime){this.dateClicked=false}q&&this.callHandler()}i.classList.remove("hilite");if(l&&!r.params.showsTime){r.dateClicked=false;q&&this.close()}};b.prototype._handleCalKeyEvent=function(j){var i=this,h=j.keyCode;if(j.target===this.inputField&&(h===13||h===9)){this.close()}if(i.params.direction==="rtl"){if(h===37){h=39}else{if(h===39){h=37}}}if(h===32){if(j.shiftKey){j.preventDefault();this.cellClick(i._nav_now,j);i.close()}}if(h===27){this.close()}if(h===38){this.moveCursorBy(7)}if(h===40){this.moveCursorBy(-7)}if(h===37){this.moveCursorBy(1)}if(h===39){this.moveCursorBy(-1)}if(j.target===this.inputField&&!(h>48||h<57||h===186||h===189||h===190||h===32)){return e(j)}};b.prototype._create=function(){var u=this,q=this.element,C=d("table"),s=d("div");this.table=C;C.className="table";C.cellSpacing=0;C.cellPadding=0;C.style.marginBottom=0;this.dropdownElement=s;q.appendChild(s);if(this.params.direction){s.style.direction=this.params.direction}s.className="js-calendar";s.style.position="absolute";s.style.boxShadow="0px 0px 70px 0px rgba(0,0,0,0.67)";s.style.minWidth=this.inputField.width;s.style.padding="0";s.style.display="none";s.style.left="auto";s.style.top="auto";s.style.zIndex=1060;s.style.borderRadius="20px";this.wrapper=d("div");this.wrapper.className="calendar-container";s.appendChild(this.wrapper);this.wrapper.appendChild(C);var B=d("thead",C);B.className="calendar-header";var k=null,o=null,r=this,n=function(I,F,E,H,G,D,i){H=H?H:"td";G=G?G:{};k=d(H,o);if(F){D=D?'class="'+D+'"':"";k.colSpan=F}for(var j in G){k.style[j]=G[j]}for(var j in i){k.setAttribute(j,i[j])}if(E!==0&&Math.abs(E)<=2){k.className+=" nav"}if(F){k.addEventListener("mousedown",u._dayMouseDown,true)}k.calendar=r;k.navtype=E;if(E!==0&&Math.abs(E)<=2){k.innerHTML="<a "+D+" style='display:inline;padding:2px 6px;cursor:pointer;text-decoration:none;' unselectable='on'>"+I+"</a>"}else{k.innerHTML=F?"<div unselectable='on'"+D+">"+I+"</div>":I;if(!F&&D){k.className=D}}return k};if(this.params.compressedHeader===false){o=d("tr",B);o.className="calendar-head-row";this._nav_py=n("&lsaquo;",1,-2,"",{"text-align":"center","font-size":"18px","line-height":"18px"},"js-btn btn-prev-year");this.title=n('<div style="text-align:center;font-size:18px"><span></span></div>',this.params.weekNumbers?6:5,300);this.title.className="title";this._nav_ny=n(" &rsaquo;",1,2,"",{"text-align":"center","font-size":"18px","line-height":"18px"},"js-btn btn-next-year")}o=d("tr",B);o.className="calendar-head-row";this._nav_pm=n("&lsaquo;",1,-1,"",{"text-align":"center","font-size":"2em","line-height":"1em"},"js-btn btn-prev-month");this._nav_month=n('<div style="text-align:center;font-size:1.2em"><span></span></div>',this.params.weekNumbers?6:5,888,"td",{textAlign:"center"});this._nav_month.className="title";this._nav_nm=n(" &rsaquo;",1,1,"",{"text-align":"center","font-size":"2em","line-height":"1em"},"js-btn btn-next-month");o=d("tr",B);o.className=u.params.weekNumbers?"daynames wk":"daynames";if(this.params.weekNumbers){k=d("td",o);k.className="day-name wn";k.innerHTML=JoomlaCalLocale.wk}for(var z=7;z>0;--z){k=d("td",o);if(!z){k.calendar=u}}this.firstdayname=(this.params.weekNumbers)?o.firstChild.nextSibling:o.firstChild;var A=this.params.firstDayOfWeek,k=this.firstdayname,w=JoomlaCalLocale.weekend;for(var z=0;z<7;++z){var m=(z+A)%7;k.classList.add("day-name");this.params.weekNumbers?k.classList.add("day-name-week"):"";if(z){k.calendar=u;k.fdow=m}if(w.indexOf(w)!==-1){k.classList.add("weekend")}k.innerHTML=JoomlaCalLocale.shortDays[(z+A)%7];k=k.nextSibling}var h=d("tbody",C);this.tbody=h;for(z=6;z>0;--z){o=d("tr",h);if(this.params.weekNumbers){k=d("td",o)}for(var y=7;y>0;--y){k=d("td",o);k.calendar=this;k.addEventListener("mousedown",this._dayMouseDown,true)}}if(this.params.showsTime){o=d("tr",h);o.className="time";k=d("td",o);k.className="time time-title";k.colSpan=1;k.style.verticalAlign="middle";k.innerHTML=" ";var v=d("td",o);v.className="time hours-select";v.colSpan=2;var t=d("td",o);t.className="time minutes-select";t.colSpan=2;(function(){function G(S,O,H,V,U){var M=d("select",U),R;M.calendar=u;M.className=S;M.setAttribute("data-chosen",true);M.style.width="100%";M.navtype=50;M._range=[];for(var Q=H;Q<=V;++Q){var P,T="";if(Q===O){T=true}if(Q<10&&V>=10){R="0"+Q;P=Date.convertNumbers("0")+Date.convertNumbers(Q)}else{R=""+Q;P=""+Date.convertNumbers(Q)}M.options.add(new Option(P,R,T,T))}return M}var L=u.date.getHours(),i=u.date.getMinutes(),N=!u.params.time24,E=(u.date.getHours()>12);if(N&&E){L-=12}var J=G("time time-hours",L,N?1:0,N?12:23,v),F=G("time time-minutes",i,0,59,t),K=null;k=d("td",o);k.className="time ampm-select";k.colSpan=u.params.weekNumbers?1:2;if(N){var I=true,D=Date.parseFieldDate(u.inputField.getAttribute("data-alt-value"),u.params.dateFormat,"gregorian");E=(D.getHours()>=12);var j=d("select",k);j.className="time-ampm";j.style.width="100%";j.options.add(new Option(JoomlaCalLocale.PM,"pm",E?I:"",E?I:""));j.options.add(new Option(JoomlaCalLocale.AM,"am",E?"":I,E?"":I));K=j;K.addEventListener("change",function(H){u.updateTime(H.target.parentNode.parentNode.childNodes[1].childNodes[0].value,H.target.parentNode.parentNode.childNodes[2].childNodes[0].value,H.target.parentNode.parentNode.childNodes[3].childNodes[0].value)},false)}else{k.innerHTML="&#160;";k.colSpan=u.params.weekNumbers?3:2}J.addEventListener("change",function(H){u.updateTime(H.target.parentNode.parentNode.childNodes[1].childNodes[0].value,H.target.parentNode.parentNode.childNodes[2].childNodes[0].value,H.target.parentNode.parentNode.childNodes[3].childNodes[0].value)},false);F.addEventListener("change",function(H){u.updateTime(H.target.parentNode.parentNode.childNodes[1].childNodes[0].value,H.target.parentNode.parentNode.childNodes[2].childNodes[0].value,H.target.parentNode.parentNode.childNodes[3].childNodes[0].value)},false)})()}o=d("div",this.wrapper);o.className="buttons-wrapper btn-group";this._nav_clear=n(JoomlaCalLocale.clear,"",100,"button","","js-btn btn btn-clear",{type:"button","data-action":"clear"});var l=o.querySelector('[data-action="clear"]');l.addEventListener("click",function(D){D.preventDefault();var E=u.table.querySelectorAll("td");for(var j=0;j<E.length;j++){if(E[j].classList.contains("selected")){E[j].classList.remove("selected");break}}u.inputField.setAttribute("data-alt-value","0000-00-00 00:00:00");u.inputField.setAttribute("value","");u.inputField.value="";u.inputField.dispatchEvent(new Event("change",{bubbles:true,cancelable:true}))});if(this.params.showsTodayBtn){this._nav_now=n(JoomlaCalLocale.today,"",0,"button","","js-btn btn btn-today",{type:"button","data-action":"today"});var p=this.wrapper.querySelector('[data-action="today"]');p.addEventListener("click",function(i){i.preventDefault();u.date.setLocalDateOnly("gregorian",new Date());u.dateClicked=true;u.callHandler();u.close()})}this._nav_exit=n(JoomlaCalLocale.exit,"",999,"button","","js-btn btn btn-exit",{type:"button","data-action":"exit"});var x=this.wrapper.querySelector('[data-action="exit"]');x.addEventListener("click",function(i){i.preventDefault();if(!u.dateClicked){if(u.inputField.value){if(u.params.dateType!=="gregorian"){u.inputField.setAttribute("data-local-value",u.inputField.value)}if(typeof u.dateClicked==="undefined"){u.inputField.setAttribute("data-alt-value",Date.parseFieldDate(u.inputField.value,u.params.dateFormat,u.params.dateType).print(u.params.dateFormat,"gregorian",false))}else{u.inputField.setAttribute("data-alt-value",u.date.print(u.params.dateFormat,"gregorian",false))}}else{u.inputField.setAttribute("data-alt-value","0000-00-00 00:00:00")}u.date=Date.parseFieldDate(u.inputField.getAttribute("data-alt-value"),u.params.dateFormat,u.params.dateType)}u.close()});this.processCalendar()};b.prototype.processCalendar=function(){this.table.style.visibility="hidden";var y=this.params.firstDayOfWeek,M=this.date,K=new Date(),D=K.getLocalFullYear(this.params.dateType),O=K.getLocalMonth(this.params.dateType),k=K.getLocalDate(this.params.dateType),w=M.getOtherFullYear(this.params.dateType),L=M.getHours(),q=M.getMinutes(),o=M.getSeconds(),I=!this.params.time24;if(w<this.params.minYear){w=this.params.minYear;M.setOtherFullYear(this.params.dateType,w)}else{if(w>this.params.maxYear){w=this.params.maxYear;M.setOtherFullYear(this.params.dateType,w)}}this.params.firstDayOfWeek=y;this.date=new Date(M);var N=M.getLocalMonth(this.params.dateType);var P=M.getLocalDate(this.params.dateType);M.setLocalDate(this.params.dateType,1);var E=(M.getLocalDay(this.params.dateType)-this.params.firstDayOfWeek)%7;if(E<0){E+=7}M.setLocalDate(this.params.dateType,-E);M.setLocalDate(this.params.dateType,M.getLocalDate(this.params.dateType)+1);var p=this.tbody.firstChild,A=this.ar_days=new Array(),z=JoomlaCalLocale.weekend,C=parseInt(M.getLocalWeekDays(this.params.dateType));for(var H=0;H<C;++H,p=p.nextSibling){var h=p.firstChild;if(this.params.weekNumbers){h.className="day wn";h.innerHTML=M.getLocalWeekNumber(this.params.dateType);h=h.nextSibling}p.className=this.params.weekNumbers?"daysrow wk":"daysrow";var J=false,t,l=A[H]=[],n=C+1;for(var F=0;F<n;++F,h=h.nextSibling,M.setLocalDate(this.params.dateType,t+1)){h.className="day";h.style.textAlign="center";t=M.getLocalDate(this.params.dateType);var v=M.getLocalDay(this.params.dateType);h.pos=H<<4|F;l[F]=h;var x=(M.getLocalMonth(this.params.dateType)===N);if(!x){if(this.params.showsOthers){h.className+=" disabled othermonth ";h.otherMonth=true}else{h.className+=" emptycell";h.innerHTML="&#160;";h.disabled=true;continue}}else{h.otherMonth=false;J=true;h.style.cursor="pointer"}h.disabled=false;h.innerHTML=this.params.debug?t:Date.convertNumbers(t);if(!h.disabled){h.caldate=new Date(M);if(x&&t===P){h.className+=" selected";this.currentDateEl=h}if(M.getLocalFullYear(this.params.dateType)===D&&M.getLocalMonth(this.params.dateType)===O&&t===k){h.className+=" today"}if(z.indexOf(v)!==-1){h.className+=" weekend"}}}if(!(J||this.params.showsOthers)){p.style.display="none";p.className="emptyrow"}else{p.style.display=""}}if(this.params.showsTime){if(L>12&&I){L-=12}L=(L<10)?"0"+L:L;q=(q<10)?"0"+q:q;var s=this.table.querySelector(".time-hours"),r=this.table.querySelector(".time-minutes");this.resetSelected(s);if(!this.params.time24){s.value=(L=="00")?"12":L}else{s.value=L}this.resetSelected(r);r.value=q;if(!this.params.time24){var G=new Date(this.inputField.getAttribute("data-alt-value")),m=this.table.querySelector(".time-ampm"),u=G.getHours();if(u>12){this.resetSelected(m);m.value="pm"}}}if(!this.params.compressedHeader){this._nav_month.getElementsByTagName("span")[0].innerHTML=this.params.debug?N+" "+JoomlaCalLocale.months[N]:JoomlaCalLocale.months[N];this.title.getElementsByTagName("span")[0].innerHTML=this.params.debug?w+" "+Date.convertNumbers(w.toString()):Date.convertNumbers(w.toString())}else{var B=Date.convertNumbers(w.toString());this._nav_month.getElementsByTagName("span")[0].innerHTML=!this.params.monthBefore?JoomlaCalLocale.months[N]+" - "+B:B+" - "+JoomlaCalLocale.months[N]}this.table.style.visibility="visible"};b.prototype._bindEvents=function(){var h=this;this.inputField.addEventListener("blur",function(l){var i=b.getCalObject(this)._joomlaCalendar;if(i.dropdownElement.style.display==="block"){l.preventDefault();return}if(i){if(i.inputField.value){if(typeof i.params.dateClicked==="undefined"){i.inputField.setAttribute("data-local-value",i.inputField.value);if(i.params.dateType!=="gregorian"){var k,j=Date.parseFieldDate(i.inputField.value,i.params.dateFormat,i.params.dateType);k=Date.localCalToGregorian(j.getFullYear(),j.getMonth(),j.getDate());j.setFullYear(k[0]);j.setMonth(k[1]);j.setDate(k[2]);i.inputField.setAttribute("data-alt-value",j.print(i.params.dateFormat,"gregorian",false))}else{i.inputField.setAttribute("data-alt-value",Date.parseFieldDate(i.inputField.value,i.params.dateFormat,i.params.dateType).print(i.params.dateFormat,"gregorian",false))}}else{i.inputField.setAttribute("data-alt-value",i.date.print(i.params.dateFormat,"gregorian",false))}}else{i.inputField.setAttribute("data-alt-value","0000-00-00 00:00:00")}i.date=Date.parseFieldDate(i.inputField.getAttribute("data-alt-value"),i.params.dateFormat,i.params.dateType)}h.close()},true);this.button.addEventListener("click",function(){h.show()},false)};var e=function(h){h||(h=f.event);h.preventDefault();h.stopPropagation();return false};var d=function(j,i){var h=null;h=a.createElement(j);if(typeof i!=="undefined"){i.appendChild(h)}return h};var g=function(h){return !isNaN(h)&&(function(i){return(i|0)===i})(parseFloat(h))};var c=function(h,j){var i=new Date();var k=i.getLocalFullYear(j);return k+h};if(!Array.prototype.indexOf){Array.prototype.indexOf=function(i){var h=this.length>>>0,j=Number(arguments[1])||0;j=(j<0)?Math.ceil(j):Math.floor(j);if(j<0){j+=h}for(;j<h;j++){if(j in this&&this[j]===i){return j}}return -1}}b.getCalObject=function(h){if(!h){return false}while(h.parentNode){h=h.parentNode;if(h.classList.contains("field-calendar")){return h}}return false};b.prototype.setAltValue=function(){var h=this.inputField;if(h.getAttribute("disabled")){return}h.value=h.getAttribute("data-alt-value")?h.getAttribute("data-alt-value"):""};b.onSubmit=function(){Joomla=f.Joomla||{};if(!Joomla.calendarProcessed){Joomla.calendarProcessed=true;var l=a.querySelectorAll(".field-calendar");for(var k=0;k<l.length;k++){var j=l[k],h=j._joomlaCalendar;if(h){h.setAltValue()}}}};b.init=function(j,i){f.JoomlaCalLocale=f.JoomlaCalLocale?JoomlaCalLocale:{};JoomlaCalLocale.today=JoomlaCalLocale.today?JoomlaCalLocale.today:"today";JoomlaCalLocale.weekend=JoomlaCalLocale.weekend?JoomlaCalLocale.weekend:[0,6];JoomlaCalLocale.localLangNumbers=JoomlaCalLocale.localLangNumbers?JoomlaCalLocale.localLangNumbers:[0,1,2,3,4,5,6,7,8,9];JoomlaCalLocale.wk=JoomlaCalLocale.wk?JoomlaCalLocale.wk:"wk";JoomlaCalLocale.AM=JoomlaCalLocale.AM?JoomlaCalLocale.AM:"AM";JoomlaCalLocale.PM=JoomlaCalLocale.PM?JoomlaCalLocale.PM:"PM";JoomlaCalLocale.am=JoomlaCalLocale.am?JoomlaCalLocale.am:"am";JoomlaCalLocale.pm=JoomlaCalLocale.pm?JoomlaCalLocale.pm:"pm";JoomlaCalLocale.dateType=JoomlaCalLocale.dateType?JoomlaCalLocale.dateType:"gregorian";JoomlaCalLocale.time=JoomlaCalLocale.time?JoomlaCalLocale.time:"time";JoomlaCalLocale.days=JoomlaCalLocale.days?JoomlaCalLocale.days:'["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"]';JoomlaCalLocale.shortDays=JoomlaCalLocale.shortDays?JoomlaCalLocale.shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"];JoomlaCalLocale.months=JoomlaCalLocale.months?JoomlaCalLocale.months:["January","February","March","April","May","June","July","August","September","October","November","December"];JoomlaCalLocale.shortMonths=JoomlaCalLocale.shortMonths?JoomlaCalLocale.shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];JoomlaCalLocale.minYear=JoomlaCalLocale.minYear?JoomlaCalLocale.minYear:1900;JoomlaCalLocale.maxYear=JoomlaCalLocale.maxYear?JoomlaCalLocale.maxYear:2100;JoomlaCalLocale.exit=JoomlaCalLocale.exit?JoomlaCalLocale.exit:"Cancel";JoomlaCalLocale.clear=JoomlaCalLocale.clear?JoomlaCalLocale.clear:"Clear";var h=j._joomlaCalendar;if(!h){new b(j)}else{h.recreate()}if(j&&j.getElementsByTagName("input")[0]&&j.getElementsByTagName("input")[0].form&&!j.getElementsByTagName("input")[0].disabled){j.getElementsByTagName("input")[0].form.addEventListener("submit",b.onSubmit)}};f.JoomlaCalendar=b;a.addEventListener("DOMContentLoaded",function(){var j,h;j=a.querySelectorAll(".field-calendar");for(h=0;h<j.length;h++){b.init(j[h])}f.jQuery&&jQuery(a).on("subform-row-add",function(i,k){j=k.querySelectorAll(".field-calendar");for(h=0;h<j.length;h++){b.init(j[h])}});f.Calendar={};Calendar.setup=function(m){if(m.inputField&&a.getElementById(m.inputField)){var i=a.getElementById(m.inputField),l=i.parentNode.querySelectorAll("button")[0];for(var k in m){if(m.hasOwnProperty(k)){switch(k){case"ifFormat":if(l){l.setAttribute("data-dayformat",m.ifFormat)}break;case"firstDay":if(l){l.setAttribute("data-firstday",parseInt(m.firstDay))}break;case"weekNumbers":if(l){l.setAttribute("data-week-numbers",(m.weekNumbers==="true"||m.weekNumbers===true)?"1":"0")}break;case"showOthers":if(l){l.setAttribute("data-show-others",(m.showOthers==="true"||m.showOthers===true)?"1":"0")}break;case"showsTime":if(l){l.setAttribute("data-show-time",(m.showsTime==="true"||m.showsTime===true)?"1":"0")}break;case"timeFormat":if(l){l.setAttribute("data-time-24",parseInt(m.timeFormat))}break;case"displayArea":case"inputField":case"button":case"eventName":case"daFormat":case"disableFunc":case"dateStatusFunc":case"dateTooltipFunc":case"dateText":case"align":case"range":case"flat":case"flatCallback":case"onSelect":case"onClose":case"onUpdate":case"date":case"electric":case"step":case"position":case"cache":case"multiple":break}}}b.init(i.parentNode.parentNode)}return null}})})(window,document);
>>>>>>> e1b2f01623577002e6d005616cb059ca4e2f8090
